/**
*
*   PrismGrammar
*   @version: 1.0
*
*   Transform a grammar specification in JSON format, into a syntax-highlighter for Prism
*   https://github.com/foo123/prism-grammar
*
**/!function(t,n,e){"use strict";var r,l="object"==typeof module&&module.exports,o="function"==typeof define&&define.amd;l?module.exports=(module.$deps=module.$deps||{})[n]=module.$deps[n]||e.call(t,{NODE:module})||1:o&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["require","exports","module"],function(n,r,l){return e.call(t,{AMD:l})}):n in t||(t[n]=r=e.call(t,{})||1)&&o&&define(n,[],function(){return r})}(this,"PrismGrammar",function(t){"use strict";function n(t,n){var e,r=this;return(e=t.chr(r.tp,n))?[r.tk,e]:!1}function e(t,n){var e,r=this;return(e=t.chl(r.tp,n))?[r.tk,e]:!1}function r(t,n){var e,r=this;return(e=t.str(r.tp,r.p,n))?[r.tk,e]:!1}function l(t,n){var e,r=this;return(e=t.rex(r.tp,r.p,r.np,r.tg,n))?[r.tk,e]:!1}function o(t,n){var e=this;return!1!==n&&t.end(),[e.tk,""]}function s(t,n,e,r){var l=gn(n);if(Y===l)return n;if(r[t])return r[t];e=e||0;var o,s=0;return n&&n.isCharList&&(s=1,delete n.isCharList),o=un&l?new zn(un,t,n,e):tn===l?new zn(tn,t,n,e):X&l?s?new zn(nn,t,n,e):new zn(X,t,n,e):en&l?new zn(on,t,n,e):n,r[t]=o}function u(t,n,e,r,l,o){if(o[t])return o[t];var i,c,a,p,f,h,g,k=0,d=0,E=1;if(i=Rn(n),a=i.length,1===a)g=s(t,jn(i[0],e,l),0,o);else if(a>1){for(p=(a>>1)+1,c=0;p>=c;c++)f=gn(i[c]),h=gn(i[a-1-c]),(tn!==f||tn!==h)&&(E=0),en&f||en&h?k=1:(Dn(i[c],e)||Dn(i[a-1-c],e))&&(d=1);if(!E||r&&X&gn(r))if(!r||k||d){for(c=0;a>c;c++)i[c]=en&gn(i[c])?u(t+"_"+c,i[c],e,r,l,o):s(t+"_"+c,jn(i[c],e,l),c,o);g=a>1?new Fn(t,i):i[0]}else g=s(t,Gn(i,r),0,o);else i=i.slice().join(""),i.isCharList=1,g=s(t,i,0,o)}return o[t]=g}function i(t,n,e,r,l){if(l[t])return l[t];var o,u,i,c,a,p,f;for(c=[],a=[],o=mn(n),u=0,i=o.length;i>u;u++)p=s(t+"_0_"+u,jn(o[u][0],e,r),u,l),f=o[u].length>1?on!==p.tt||X!==gn(o[u][1])||Dn(o[u][1],e)?s(t+"_1_"+u,jn(o[u][1],e,r),u,l):o[u][1]:p,c.push(p),a.push(f);return l[t]=new Vn(t,c,a)}function c(t,n,e,r){var l,o,s,u,i,a,p,f,h,g;if("undefined"==typeof t.pos?(a=new String(An(t)),a.pos=0):a=t,1===a.length)g=""+t,n[g]||(n[g]={type:"simple",tokens:t}),t=g;else{for(l=[],o=[],s="";a.pos<a.length;)if(f=a.charAt(a.pos++),xn.test(f))if(s.length&&(n[s]||e[s]||(n[s]={type:"simple",tokens:s}),o.push(s),s=""),'"'===f||"'"===f){for(p=f,u="";a.pos<a.length&&p!==(f=a.charAt(a.pos++));)u+=f;u.length?(g=""+u,n[g]||(n[g]={type:"simple",tokens:u}),o.push(g)):o.push(0)}else if("*"===f||"+"===f||"?"===f)h=o.pop(),g=""+h+f,e[g]||(e[g]={type:"group",match:"*"===f?"zeroOrMore":"+"===f?"oneOrMore":"zeroOrOne",tokens:[h]}),o.push(g);else if("{"===f){for(i="";a.pos<a.length&&"}"!==(f=a.charAt(a.pos++));)i+=f;i=i.split(",").map(An),i[0]=i[0].length?parseInt(i[0],10)||0:0,0>i[0]&&(i[0]=0),2>i.length?i.push(i[0]):i[1]=i[1].length?parseInt(i[1],10)||m:m,0>i[1]&&(i[1]=0),h=o.pop(),g=""+h+["{",i[0]||"",",",isFinite(i[1])?i[1]||"":"","}"].join(""),e[g]||(e[g]={type:"group",match:[i[0],i[1]],tokens:[h]}),o.push(g)}else{if("}"===f)continue;if("|"===f)o.length>1?(g=""+o.join(" "),e[g]||(e[g]={type:"group",match:"sequence",tokens:o}),l.push(g)):o.length&&l.push(o[0]),o=[];else if("("===f)h=c(a,n,e,!0),g="("+h+")",e[g]||(e[g]=vn(n[h]||e[h])),o.push(g);else if(")"===f){if(r)break;continue}}else s+=f;s.length&&(n[s]||e[s]||(n[s]={type:"simple",tokens:s}),o.push(s)),s="",o.length>1?(g=""+o.join(" "),e[g]||(e[g]={type:"group",match:"sequence",tokens:o}),l.push(g)):o.length&&l.push(o[0]),o=[],l.length>1?(g=""+l.join(" | "),e[g]||(e[g]={type:"group",match:"either",tokens:l}),t=g):l.length&&(t=l[0]),l=[]}return t}function a(t,n,e,r,l,o,s,h,g,k,d){var v,y,_,w,x,L,Q,q,F,$,U,Z,H,Y,J,W,tn=null;if(null===t)return new $n(C,"EOL",t);if(""===t)return new $n(b,"NONSPACE",t);if(!1===t||0===t)return new $n(O,"EMPTY",t);if(en&gn(t)&&(W=t,t="NGRAM_"+W.join("_"),r[t]||(r[t]={type:"ngram",tokens:W})),t=""+t,h[t])return h[t];for(e[t]?(v=e[t],pn&gn(v)&&(v=e[t]={type:"simple",tokens:v})):v=r[t]?r[t]:t,X&gn(v)&&(v=c(v,e,r),v=e[v]||r[v]);v.extend;)Y=v.extend,J=e[Y]||r[Y],delete v.extend,J&&(pn&gn(J)&&(J={type:"simple",tokens:J}),v=yn(J,v));if("undefined"==typeof v.type&&(v.either?(v.type="group",v.match="either",v.tokens=v.either,delete v.either):v.all||v.sequence?(v.type="group",v.match="sequence",v.tokens=v.all||v.sequence,v.all?delete v.all:delete v.sequence):v.zeroOrMore?(v.type="group",v.match="zeroOrMore",v.tokens=v.zeroOrMore,delete v.zeroOrMore):v.oneOrMore?(v.type="group",v.match="oneOrMore",v.tokens=v.oneOrMore,delete v.oneOrMore):v.zeroOrOne?(v.type="group",v.match="zeroOrOne",v.tokens=v.zeroOrOne,delete v.zeroOrOne):v.type="simple"),y=v.type?V[v.type.toUpperCase().replace(Mn,"")]:S,S&y){if(""===v.tokens)return tn=new $n(b,t,t),h[t]=tn,tn;if(null===v.tokens)return tn=new $n(C,t,t),h[t]=tn,tn;if(!1===v.tokens||0===v.tokens)return tn=new $n(O,t,t),h[t]=tn,tn}if(v.tokens=Rn(v.tokens),S&y)v.autocomplete&&f(v,t,d),v.push?(v.action||(v.action=["push",v.push]),delete v.push):v[K]("pop")&&(v.action||(v.action=["pop",v.pop]),delete v.pop),w=null,v.action&&v.action[0]&&("push"===v.action[0]?w=[E,v.action[1]]:"pop"===v.action[0]&&(w=[R,v.action[1]])),_="undefined"==typeof v.combine?"\\b":v.combine,tn=new $n(S,t,u(t,v.tokens.slice(),n,_,o,s)),tn.ta=w,h[t]=tn;else if(A&y)T&y&&p(v,k),tn=new Kn(y,t,i(t,v.tokens.slice(),n,o,s),v.multiline,v.escape,l[t+".inside"]?1:0),h[t]=tn,v.interleave&&g.push(tn.clone());else if(P&y){for(L=v.tokens.slice(),en&gn(v.match)?tn=new Un(j,t,null,v.match[0],v.match[1]):(x=z[v.match.toUpperCase()],tn=G===x?new Un(G,t,null,0,1):I===x?new Un(I,t,null,0,m):N===x?new Un(N,t,null,1,m):M&x?new Un(M,t,null):new Un(D,t,null)),h[t]=tn,Q=[],$=0,U=L.length;U>$;$++)Q=Q.concat(a(L[$],n,e,r,l,o,s,h,g,k,d));tn.set(Q)}else if(B&y){for(tn=mn(v.tokens.slice()).slice(),q=[],$=0,U=tn.length;U>$;$++)q[$]=tn[$].slice(),tn[$]=new Un(B,t+"_NGRAM_"+$,null);for(h[t]=tn,$=0,U=tn.length;U>$;$++){for(F=q[$],Q=[],Z=0,H=F.length;H>Z;Z++)Q=Q.concat(a(F[Z],n,e,r,l,o,s,h,g,k,d));tn[$].set(Q)}}return h[t]}function p(t,n){var e,r,l,o,s,u=mn(t.tokens.slice());for(o=0,s=u.length;s>o;o++)e=u[o][0],r=u[o].length>1?u[o][1]:u[o][0],l=u[o].length>2?u[o][2]:"",null===r?(n.line=n.line||[],n.line.push(e)):(n.block=n.block||[],n.block.push([e,r,l]))}function f(t,n,e){var r=[].concat(Rn(t.tokens)).map(function(t){return{word:t,meta:n}});e.autocomplete=(e.autocomplete||[]).concat(r)}function h(t){var n,e,r,l,o,s,u,i,c,p,f,h,g,k,d,E;if(t.__parsed)return t;for(f={},h={},g={},d={},E={},k=[],t=vn(t),n=t.RegExpID||null,t.RegExpID=null,delete t.RegExpID,s=t.Lex||{},t.Lex=null,delete t.Lex,u=t.Syntax||{},t.Syntax=null,delete t.Syntax,o=t.Style||{},l=t.Parser||[],r=l.length,e=[],i=0;r>i;i++)c=l[i],p=a(c,n,s,u,o,f,h,g,k,d,E)||null,p&&(en&gn(p)?e=e.concat(p):e.push(p));return t.Parser=e,t.cTokens=k,t.Style=o,t.Comments=d,t.Keywords=E,t.Extra=t.Extra||{},t.__parsed=1,t}function g(t){var n,e=new Yn(h(t),{DEFAULT:k,ERROR:d}),r=0,l=null,o={"before-highlight":function(t){l===t.language&&(t._code=t.code,t.code="")},"before-insert":function(t){l===t.language&&(t.code=t._code,t._code="",t.highlightedCode=n.Token.stringify(e.parse(t.code),t.language))}};return{hook:function(t,e){if(!r){n=t,l=e;for(var s in o)o[K](s)&&n.hooks.add(s,o[s]);r=1}},unhook:function(){if(r){var t,e,l=n.hooks.all;for(t in o)l[K](t)&&o[K](t)&&(e=l[t].indexOf(o[t]),e>-1&&l[t].splice(e,1));r=0}}}}var k,d,E=1,R=2,m=1/0,v=2,y=4,_=8,S=16,C=17,b=18,O=20,A=32,w=33,T=34,M=64,x=128,D=x,j=256,G=257,I=258,N=259,P=512,B=1024,L=D|B,Q=2048,q=4096,z={EITHER:M,ALL:x,SEQUENCE:D,ZEROORONE:G,ZEROORMORE:I,ONEORMORE:N,REPEATED:j},V={INDENT:Q,DEDENT:q,BLOCK:A,COMMENT:T,ESCAPEDBLOCK:w,SIMPLE:S,GROUP:P,NGRAM:B},F=void 0,$="prototype",K="hasOwnProperty",U="propertyIsEnumerable",Z=(Object.keys,Array[$],Object[$]),H=(Function[$],Z.toString),Y=4,J=5,W=8,X=16,tn=17,nn=18,en=32,rn=64,ln=128,on=256,sn=512,un=1024,cn=2048,an=4096,pn=X|en,fn=rn|en,hn={"[object Array]":en,"[object RegExp]":on,"[object Date]":sn,"[object Number]":Y,"[object String]":X,"[object Function]":ln,"[object Object]":rn},gn=function(t){var n;return null===t?un:!0===t||!1===t?W:F===t?cn:(n=H.call(t),n=hn[n]||an,Y===n||t instanceof Number?isNaN(t)?J:Y:X===n||t instanceof String?1===t.length?tn:X:en===n||t instanceof Array?en:on===n||t instanceof RegExp?on:sn===n||t instanceof Date?sn:ln===n||t instanceof Function?ln:rn===n?rn:an)},kn=function(){var t,n,e,r,l,o,s,u=arguments;for(n=u[0]||{},t=u.length,o=1;t>o;o++)if(e=u[o],rn===gn(e))for(l in e)e[K](l)&&e[U](l)&&(r=e[l],s=gn(r),n[l]=Y&s?0+r:pn&s?r.slice():r);return n},dn=Object.create,En=function(t,n){var e,r=arguments.length,l="constructor";return 0===r?(t=Object,n={}):1===r?(n=t||{},t=Object):(t=t||Object,n=n||{}),n[K](l)||(n[l]=function(){}),e=n[l],delete n[l],e[$]=kn(dn(t[$]),n),e[$][l]=e,e},Rn=function(t,n){return n||en!==gn(t)?[t]:t},mn=function(t,n){return t=Rn(t,n),(n||en!==gn(t[0]))&&(t=[t]),t},vn=function(t){var n,e=gn(t);if(!(fn&e))return t;var r,l={};for(r in t)t[K](r)&&t[U](r)&&(n=gn(t[r]),l[r]=rn&n?vn(t[r]):pn&n?t[r].slice():t[r]);return l},yn=function(){var t=arguments,n=t.length;if(1>n)return null;if(2>n)return vn(t[0]);var e,r,l,o,s=t[0],u=vn(s);for(n--,r=1;n>r;r++)if(e=t[r])for(l in e)e[K](l)&&e[U](l)&&(s[K](l)&&s[U](l)?(o=gn(s[l]),rn&~X&o&&(u[l]=yn(s[l],e[l]))):u[l]=vn(e[l]));return u},_n=/([.*+?^${}()|[\]\/\\\-])/g,Sn=function(t){return t.replace(_n,"\\$1")},Cn=/\$(\d{1,2})/g,bn=function(t,n){var e,r,l,o;for(o=function(t,e){return n[1+parseInt(e,10)]},e=t.split("$$"),l=e.length,r=0;l>r;r++)e[r]=e[r].replace(Cn,o);return e.join("$")},On=/^\s+|\s+$/g,An=String[$].trim?function(t){return t.trim()}:function(t){return t.replace(On,"")},wn=function(t,n){return n.length-t.length},Tn=/\r\n|\r|\n/g,Mn=/[\-_]/g,xn=/^([{}()*+?|'"]|\s)/,Dn=function(t,n){return X&gn(n)&&X&gn(t)&&n.length&&n.length<=t.length&&n==t.substr(0,n.length)},jn=function(t,n,e){if(!t||Y===gn(t))return t;var r,l=n?n.length||0:0;if(l&&n==t.substr(0,l)){var o,s,u,i,r,c,a=t.substr(l),p=a[0],f="";for(r=a.length;r--&&(c=a[r],p!=c);)"i"==c.toLowerCase()&&(f="i");return o=a.substring(1,r),s="^("+o+")",e[s]||(u=new RegExp(s,f),i={peek:null,negativepeek:null},e[s]=[u,i]),e[s]}return t},Gn=function(t,n){var e={},r="",l=gn(n);(X===l||tn===l)&&(r=n);var o=t.sort(wn).map(function(t){return e[t.charAt(0)]=1,Sn(t)}).join("|");return[new RegExp("^("+o+")"+r),{peek:e,negativepeek:null},1]},In=0,Nn=function(){return++In},Pn=function(t){return[t||"uuid",++In,(new Date).getTime()].join("_")},Bn=(!("undefined"==typeof global||"[object global]"!==H.call(global)),Math.max),Ln=/^[\s\u00a0]+/,Qn=/[^\s\u00a0]/,qn=En({constructor:function(t){var n=this;n._=null,n.s=t?""+t:"",n.start=n.pos=0,n.lCP=n.lCV=0,n.lS=0},_:null,s:"",start:0,pos:0,lCP:0,lCV:0,lS:0,dispose:function(){var t=this;return t._=null,t.s=null,t.start=null,t.pos=null,t.lCP=null,t.lCV=null,t.lS=null,t},toString:function(){return this.s},sol:function(){return 0===this.pos},eol:function(){return this.pos>=this.s.length},chr:function(t,n){var e=this,r=e.s.charAt(e.pos)||null;return r&&t===r?(!1!==n&&(e.pos+=1,e._&&(e._.pos=e.pos)),r):!1},chl:function(t,n){var e=this,r=e.s.charAt(e.pos)||null;return r&&-1<t.indexOf(r)?(!1!==n&&(e.pos+=1,e._&&(e._.pos=e.pos)),r):!1},str:function(t,n,e){var r,l=this,o=l.pos,s=l.s,u=s.charAt(o)||null;return u&&n[u]&&(r=t.length,t===s.substr(o,r))?(!1!==e&&(l.pos+=r,l._&&(l._.pos=l.pos)),t):!1},rex:function(t,n,e,r,l){{var o,s=this,u=s.pos,i=s.s;i.charAt(u)||null}return o=i.slice(u).match(t),!o||o.index>0?!1:(!1!==l&&(s.pos+=o[r||0].length,s._&&(s._.pos=s.pos)),o)},spc:function(t){var n,e=this,r=e.pos,l=e.s.slice(r);return(n=l.match(Ln))?(!1!==t&&(e.pos+=n[0].length,e._&&(e._.pos=e.pos)),1):0},end:function(){var t=this;return t.pos=t.s.length,t._&&(t._.pos=t.pos),t},nxt:function(){var t,n=this,e=n.s;return n.pos<e.length?(t=e.charAt(n.pos++)||null,n._&&(n._.pos=n.pos),t):void 0},bck:function(t){var n=this;return n.pos=Bn(0,n.pos-t),n._&&(n._.pos=n.pos),n},bck2:function(t){var n=this;return n.pos=Bn(0,t),n._&&(n._.pos=n.pos),n},col:function(t){var n=this;return t=t||1,n.lCP<n.start&&(n.lCV=qn.col(n.s,n.start,t,n.lCP,n.lCV),n.lCP=n.start,n._&&(n._.start=n.start,n._.lastColumnPos=n.lCP,n._.lastColumnValue=n.lCV,n._.lineStart=n.lS)),n.lCV-(n.lS?qn.col(n.s,n.lS,t):0)},ind:function(t){var n=this;return t=t||1,qn.col(n.s,null,t)-(n.lS?qn.col(n.s,n.lS,t):0)},cur:function(t){var n=this,e=n.s.slice(n.start,n.pos);return t&&(n.start=n.pos),e},sft:function(){return this.start=this.pos,this}});qn.col=function(t,n,e,r,l){var o,s;for(null===n&&(n=t.search(Qn),-1==n&&(n=t.length)),o=r||0,s=l||0;n>o;++o)s+="	"==t.charAt(o)?e-s%e:1;return s},qn._=function(t){var n=new qn;return n._=t,n.s=""+t.string,n.start=t.start,n.pos=t.pos,n.lCP=t.lastColumnPos,n.lCV=t.lastColumnValue,n.lS=t.lineStart,n};var zn,Vn,Fn,$n,Kn,Un,Zn=En({constructor:function(t){this._=t||[]},_:null,dispose:function(){var t=this;return t._=null,t},toString:function(){return this._.slice().reverse().join("\n")},clone:function(){return new Zn(this._.slice())},isEmpty:function(){return 0>=this._.length},pos:function(){return this._.length},peek:function(t){var n=this,e=n._;if(t=arguments.length?t:-1,e.length){if(0>t&&0<=e.length+t)return e[e.length+t];if(t>=0&&t<e.length)return e[t]}return null},pop:function(){return this._.pop()},shift:function(){return this._.shift()},push:function(t){var n=this;return n._.push(t),n},unshift:function(t){var n=this;return n._.unshift(t),n},pushAt:function(t,n,e,r){var l=this,o=l._;return e&&r&&(n[e]=r),t<o.length?o.splice(t,0,n):o.push(n),l},empty:function(t,n){{var e=this,r=e._;r.length}if(t&&n)for(;r.length&&r[r.length-1]&&r[r.length-1][t]===n;)r.pop();else r.length=0;return e}}),Hn=En({constructor:function(t,n){var e=this;e.id=n?Pn("state"):"state",e.l=t||0,e.stack=new Zn,e.data=new Zn,e.col=0,e.indent=0,e.t=null,e.inBlock=null,e.endBlock=null},id:null,l:0,col:0,indent:0,stack:null,data:null,t:null,inBlock:null,endBlock:null,dispose:function(){var t=this;return t.stack&&t.stack.dispose(),t.data&&t.data.dispose(),t.stack=null,t.data=null,t.id=null,t.t=null,t.l=null,t.col=null,t.indent=null,t.inBlock=null,t.endBlock=null,t},clone:function(t){var n=this,e=new Hn(n.l,t);return e.t=n.t,e.col=n.col,e.indent=n.indent,e.stack=n.stack.clone(),e.data=n.data.clone(),e.inBlock=n.inBlock,e.endBlock=n.endBlock,e},toString:function(){var t=this;return["",t.id,t.l,t.t,t.inBlock||"0"].join("_")}});zn=En({constructor:function(t,s,u,i){var c=this;switch(c.mt=v,c.tt=t||tn,c.tn=s,c.tk=i||0,c.tg=0,c.tp=null,c.p=null,c.np=null,c.tt){case tn:case nn:c.tp=u,c.get=nn===c.tt?e:n;break;case X:c.tp=u,c.p={},c.p[""+u.charAt(0)]=1,c.get=r;break;case on:c.tp=u[0],c.p=u[1].peek||null,c.np=u[1].negativepeek||null,c.tg=u[2]||0,c.get=l;break;case un:c.tp=null,c.get=o}},mt:null,tt:null,tn:null,tp:null,tg:0,tk:0,p:null,np:null,get:function(){return!1},toString:function(){var t=this;return["[","Matcher: ",t.tn,", Pattern: ",t.tp?t.tp.toString():null,"]"].join("")}}),Fn=En(zn,{constructor:function(t,n,e){var r=this;r.mt=y,r.tn=t,r.ms=n,r.ownKey=!1!==e},ms:null,ownKey:!0,get:function(t,n){var e,r,l=this,o=l.ms,s=o.length,u=l.ownKey;for(e=0;s>e;e++)if(r=o[e].get(t,n))return u?[e,r[1]]:r;return!1}}),Vn=En(zn,{constructor:function(t,n,e){var r=this;r.mt=_,r.tn=t,r.s=new Fn(r.tn+"_Start",n,!1),r.e=e},s:null,e:null,get:function(t,n){var e,r=this,l=r.s,o=r.e;if(e=l.get(t,n)){var s,u=o[e[0]],i=gn(u),c=l.ms[e[0]].tt;return on===c&&(Y===i?(s=e[1][u+1],u=new zn(s.length>1?X:tn,r.tn+"_End",s)):X===i&&(s=bn(u,e[1]),u=new zn(s.length>1?X:tn,r.tn+"_End",s))),u}return!1}}),$n=En({constructor:function(t,n,e){var r=this;r.tt=t||S,r.id=n,r.tk=e,r.REQ=0,r.ERR=0,r.ACTER=0,r.MSG=null,r.CLONE=["tk"]},sID:null,id:null,tt:null,tk:null,ta:null,REQ:0,ERR:0,ACTER:0,MSG:null,CLONE:null,act:function(t,n){var e,r,l=this,o=l.ta||null,s=n.data;if(o)if(e=o[0],r=o[1],R===e)if(r){if(t&&(r=Y===gn(r)?t[1][r]:bn(r,t[1])),s.isEmpty()||r!==s.peek())return l.MSG='Token "'+r+'" No Match',s.pop(),1;s.pop()}else s.pop();else E===e&&r&&(t&&(r=Y===gn(r)?t[1][r]:bn(r,t[1])),s.push(r));return 0},get:function(t,n){var e=this,r=e.ta,l=e.tk,o=e.tt,s=e.id,u=null;if(e.MSG=null,e.ACTER=0,O===o)return e.ERR=0,e.REQ=0,!0;if(C===o){if(t.spc(),t.eol())return s}else if(b===o)e.ERR=e.REQ&&t.spc()&&!t.eol()?1:0,e.REQ=0;else if(u=l.get(t))return r&&(e.ACTER=e.act(u,n)),s;return!1},req:function(t){return this.REQ=!!t,this},err:function(){var t=this;return t.MSG?t.MSG:t.REQ?'Token "'+t.id+'" Expected':'Syntax Error: "'+t.id+'"'},clone:function(){var t,n,e,r=this,l=r.CLONE;if(t=new r.constructor,t.tt=r.tt,t.id=r.id,t.ta=r.ta?r.ta.slice():r.ta,l&&l.length)for(n=0,e=l.length;e>n;n++)t[l[n]]=r[l[n]];return t},toString:function(){var t=this;return["[","Tokenizer: ",t.id,", Matcher: ",t.tk?t.tk.toString():null,"]"].join("")}}),Kn=En($n,{constructor:function(t,n,e,r,l,o){var s=this;s.tt=t,s.id=n,s.tk=e,s.REQ=0,s.ERR=0,s.ACTER=0,s.MSG=null,s.mline="undefined"==typeof r?1:r,s.esc=l||"\\",s.inter=o,s.CLONE=["tk","mline","esc","inter"]},inter:0,mline:0,esc:null,get:function(t,n){var e,r,l,o,s,u,i,c,a,p=this,f=0,h=0,g="",k=p.mline,d=p.tk,E=p.id,R=p.tt,m=p.inter,v=m?E+".inside":E,y=0,_=w===R,S=p.esc;if(p.MSG=null,p.ACTER=0,T===R&&(p.REQ=0),s=0,n.inBlock===E?(h=1,e=n.endBlock,s=1,u=v):!n.inBlock&&(e=d.get(t))&&(h=1,n.inBlock=E,n.endBlock=e,u=E),h){if(l=n.stack.pos(),o=un===e.tt,m){if(s&&o&&t.sol())return p.REQ=0,n.inBlock=null,n.endBlock=null,!1;if(!s)return n.stack.pushAt(l,p.clone(),"sID",E),u}if(f=e.get(t),r=k,a=0,f)u=o?v:E;else for(c=t.pos;!t.eol();){if(i=t.pos,!(_&&y||!e.get(t))){m&&t.pos>i&&i>c?(u=v,t.bck2(i),a=1):(u=E,f=1);break}g=t.nxt(),y=!y&&g==S}return r=k||_&&y,f||!r&&!a?(n.inBlock=null,n.endBlock=null):n.stack.pushAt(l,p.clone(),"sID",E),u}return!1}}),Un=En($n,{constructor:function(t,n,e,r,l){var o=this;o.tt=t?t:j,o.id=n||null,o.tk=null,o.ts=null,o.REQ=0,o.ERR=0,o.ACTER=0,o.MSG=null,o.min=r||0,o.max=l||m,o.found=0,o.CLONE=["ts","min","max","found"],e&&o.set(e)},ts:null,min:0,max:1,found:0,set:function(t){return t&&(this.ts=Rn(t)),this},get:function(t,n){var e,r,l,o,s,u,i,c,a,p,f,h,g=this,k=g.tt,d=g.ts,E=d.length;if(M===k){for(i=0,c=0,g.REQ=1,g.ERR=0,g.ACTER=0,g.MSG=null,a=t.pos,e=0;E>e;e++){if(r=d[e].clone().req(1),l=r.get(t,n),i+=r.REQ?1:0,!1!==l)return g.ACTER=r.ACTER,g.MSG=r.MSG,l;r.ERR&&(c++,t.bck2(a))}return g.REQ=i>0,g.ERR=E==c&&i>0,!1}if(L&k){if(h=k&D?1:0,g.REQ=h,g.ERR=0,g.ACTER=0,g.MSG=null,a=t.pos,p=n.stack.pos(),r=d[0].clone().req(h),l=r.get(t,n),f=g.id+"_"+Nn(),!1!==l){if(!0!==l)for(var e=E-1;e>0;e--)n.stack.pushAt(p+E-e-1,d[e].clone().req(1),"sID",f);return g.ACTER=r.ACTER,g.MSG=r.MSG,l}return r.ERR?(g.ERR=h,t.bck2(a)):h&&r.REQ&&(g.ERR=1),!1}for(i=0,o=g.found,s=g.min,u=g.max,g.ERR=0,g.REQ=0,g.ACTER=0,g.MSG=null,a=t.pos,p=n.stack.pos(),f=g.id+"_"+Nn(),e=0;E>e;e++){if(r=d[e].clone().req(1),l=r.get(t,n),!1!==l){if(++o,u>=o)return g.found=o,n.stack.pushAt(p,g.clone(),"sID",f),g.found=0,g.ACTER=r.ACTER,g.MSG=r.MSG,l;break}r.REQ&&i++,r.ERR&&t.bck2(a)}return g.REQ=s>o,g.ERR=o>u||s>o&&i>0,!1}}),k="",d="";{var Yn=En({constructor:function(t,n){var e=this;e.DEF=n.DEFAULT,e.ERR=n.ERROR,e.Tokens=t.Parser||[],e.cTokens=t.cTokens.length?t.cTokens:null,e.Style=t.Style},ERR:null,DEF:null,cTokens:null,Tokens:null,Style:null,dispose:function(){var t=this;return t.ERR=null,t.DEF=null,t.cTokens=null,t.Tokens=null,t.Style=null,t},parse:function(t){t=t||"";var n,e,r=this,l=t.split(Tn),o=l.length,s=[];for(e={state:new Hn,tokens:null},n=0;o>n;n++)e=r.getLineTokens(l[n],e.state,n),s=s.concat(e.tokens),o>n+1&&s.push("\n");return s},getLineTokens:function(t,n){var e,r,l,o,s,u,i,c,a,p,f,h=this,g=h.cTokens,k=h.Tokens,d=k.length,E=null,R=h.Style,m=h.DEF,v=h.ERR;for(u=[],p=new qn(t),f=n.stack,i={type:null,content:""},c=null,a=null,p.sol()&&!f.isEmpty()&&C===f.peek().tt&&f.pop();!p.eol();)if(r=0,m===a||v===a?(i.type&&u.push(i),u.push(p.cur(1)),i={type:null,content:""}):a&&a!==i.type?(i.type&&u.push(i),i={type:a,content:p.cur(1)}):i.type&&(i.content+=p.cur(1)),a=!1,!f.isEmpty()&&b===f.peek().tt||!p.spc()){for(;!f.isEmpty()&&!p.eol();){if(g){for(o=0,l=0;o<g.length;)if(s=g[o++],n.t=c=s.get(p,n),!1!==c){a=R[c]||m,l=1;break}if(l){r=1;break}}if(s=f.pop(),n.t=c=s.get(p,n),!1!==c){if(!0!==c){a=R[c]||m,s.ACTER&&(f.empty("sID",s.sID),n.t=c=v,a=v,E=s.err()),r=1;break}}else{if(s.ERR||s.REQ){f.empty("sID",s.sID),p.nxt(),n.t=c=v,a=v,E=s.err(),r=1;break}a=!1}}if(!r){if(p.eol())break;for(e=0;d>e;e++)if(s=k[e],n.t=c=s.get(p,n),!1!==c){if(!0!==c){a=R[c]||m,s.ACTER&&(f.empty("sID",s.sID),n.t=c=v,a=v,E=s.err()),r=1;break}}else{if(s.ERR||s.REQ){f.empty("sID",s.sID),p.nxt(),n.t=c=v,a=v,E=s.err(),r=1;break}a=!1}if(!r){if(p.eol())break;p.nxt(),n.t=c=m,a=m}}}else n.t=c=m,a=m;return m===a||v===a?(i.type&&u.push(i),u.push(p.cur(1))):a&&a!==i.type?(i.type&&u.push(i),u.push({type:a,content:p.cur(1)})):i.type&&(i.content+=p.cur(1),u.push(i)),i=null,{state:n,tokens:u}}});t.PrismGrammar={VERSION:"1.0",extend:yn,parse:h,getMode:g}}return t.PrismGrammar});